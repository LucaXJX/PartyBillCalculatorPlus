# PartyBillCalculator Plus 項目演示講稿

> **對比基準點**：`bd9aa909c89b63c2f4146c32d1b123e4a24252c1`  
> **當前版本**：最新提交  
> **報告日期**：2025-01-20

---

## 開場白

各位老師、同學好！

今天我要向大家展示 **PartyBillCalculator Plus** 項目的發展歷程。

這是一個從基礎賬單計算工具演進為引入 AI 的智能聚會管理系統的完整案例。

---

## 第一部分：項目概述 📊

項目成員：徐嘉鑫 Luca（我）

分工：我負責 Plus 版本的所有內容。

今日將會從以上方向向大家介紹項目升級部分。

---

## 第二部分：三大 AI 功能模塊 🎯

### 數據庫升級

實現了數據庫由 JSON 文件轉移到 Quick-ERD 版本的 better-sqlite3 數據庫。

### AI 功能實現

引入 AI 功能實現了：

1. 賬單 OCR + LLM 智能解析
2. 食物圖片識別系統
3. 餐廳推薦系統

### 用戶體驗改進

改進了部分用戶體驗，例如：

- 排序功能
- 刪除功能
- UI 優化
- 邏輯問題等

---

## 第三部分：技術棧演進 🛠

### 當前版本新增技術

**AI/ML 技術**：

- ✅ PaddleOCR（Python 微服務）
- ✅ TensorFlow.js 4.22+（本地推理）
- ✅ Mistral AI 1.10+（LLM API）
- ✅ Playwright 1.57+（網頁爬蟲）
- ✅ Google Maps API（距離計算）

**後端升級**：

- Express 5.2+
- TypeScript 5.9+
- SQLite + 擴展表（10+ 個表）

---

## 第四部分：開發路線圖 🗺

### 開發時間線

我們先完成數據庫的升級，然後進行了 OCR 識別的設計。

食物的識別則一開始使用了百度雲的 API，但是在有限的時間都想要自己部署訓練 AI 模型，因此繼續開發了三層式結構的 Transfer Learning 模型。

### 使用的數據集

使用了一些圖片網站的 Dataset，例如：

- Food-101
- ImageNet
- ChineseFoodNet
- Assignment3-2 的分類後的數據

### 三個 AI 框架的設計

我們設計使用：

1. OCR 獲取文字
2. LLM 整理成固定格式
3. 訓練 AI 進行食物識別
4. 獲取 API 或相對正確的資料
5. 將用戶的數據和餐廳的數據整合給 LLM
6. 獲取一部分的評核
7. 通過加權算法得到推薦指數
8. 推薦給客戶篩選
9. 以此進行正反饋

### 前後端模塊

前後端的 Modules 新增了：

- AI 服務模塊
- 食物識別
- 推薦算法
- 外部 API 的部分

---

## 第五部分：使用說明 📖

### 1. 環境設置

- Clone Git repo
- 安裝依賴
- 設置 env 變量
- 註冊輸入自己的 API KEY
- 運行 `db:migrate` 完成數據庫結構初始化

### 2. OCR 服務

- 進入路徑
- 創建虛擬環境
- 加載虛擬狀態
- 安裝依賴
- 運行 main.py

### 3. 食物識別

- 進入到路徑中
- 創建虛擬環境
- 安裝依賴
- 加載虛擬狀態
- 分不同的結構部分訓練
- 轉換訓練結果到 TensorFlow.js 格式

**注意**：如果訓練完成以後不再訓練，則這個部分可以暫時不用再進一步執行。

### 4. Server 啟動

- 先 build 後
- 然後運行 `dev:watch`
- 在 dev 模式下能看到的信息相對多一點

---

## 第六部分：模塊功能介紹 🎯

### 1. OCR 模塊

在這一個 Module，我們對於用戶上傳的收據進行文字識別，然後送給 LLM 模型，Mistral AI 分析，並幫我們生成固定的 JSON 格式文本。

在其中找到我們需要的數據，並幫用戶完成自動填寫。

同時記錄 API 的使用量，並且優化了計算機制去計算消費比例或者直接手動添加一個消費，也順便優化了折扣機制。

**簡單介紹一下圖**

### 2. 食物識別模塊

我們分成了兩個路線：

**第一個路線**：使用我們自己訓練的模型，TensorFlow 訓練得到的結果。

第三層因為我們的數據和計算量不夠，由於時間和人力有限，只能完成到第二層，去到國家分類，了解菜系，給到後期的推薦系統有一定的權重佔比。

**備選路線**：使用百度雲的食物識別 API，相對精準的結果，同時用戶還可以獲取健康資訊。

**簡單介紹一下圖**

### 3. 餐廳推薦模塊

我們經過調研，查看了不同網站的 robots.txt。

得到的結論是 OpenRice 是適合我們爬蟲的網站。

我們採用了類似於 Tinder 一樣的卡片式滑動 UI，讓用戶體驗心動模式去選擇有興趣或者收藏餐廳。

我們收集用戶上傳的圖片、喜歡和收藏的類別佔比提供給 LLM，根據食物的類型和餐廳的檢索關鍵詞進行匹配，不同的加權算法，將比較高評分的推薦給用戶。

從而達到正反饋機制。

**簡單介紹圖**

### 4. Database 模塊

我們將原有的功能全部升級到 database。

### 5. 用戶體驗改進

- 更新了一些 UI 的設計
- 新增了心動模式和收藏頁面

---

## 第七部分：關鍵技術挑戰與解決 🔧

### 挑戰 1：TensorFlow.js 模型加載失敗

**問題**：

沒有辦法 rebuild，無論是 image-dataset 還是 TensorFlow，都在安裝的時候出現了問題。

使用 Node 的路線似乎不太行得通。

**解決**：

- 改用 Python 驅動 CPU 模型
- 獲取到訓練後的模型後，轉換成 JavaScript 格式
- 直接供給 server 端調取使用
- 實現自定義 FileSystemIOHandler
- 使用 Sharp 進行圖像預處理
- 添加模型健康檢查機制

**注意**：不過 Python 真的很大（去下一頁，然後回來）

### 挑戰 2：Multer 錯誤處理

**問題**：

錯誤處理中間件使用不當導致服務器崩潰。

**解決**：

- 正確放置錯誤處理中間件
- 在路由 async try catch 塊中處理 multer 錯誤

### 挑戰 3：Playwright 爬蟲問題

**問題**：

Playwright 不是很好的能夠獲取我需要的資訊。

一開始找不到網頁裡面餐廳詳情頁面的入口，抓取不到對應的 URL link。

**解決**：

- 通過 console 和 server log 的檢查
- 修改抓取的 element 的區塊，找到正確位置
- 加入一系列的篩選、刪除重複機制
- 確保找到的資料正確

### 挑戰 4：LLM 和百度雲 API 成本控制

**問題**：

Mistral AI API 調用成本需要控制。

**解決**：

- 實現使用量追蹤系統
- 每日限制（10 次/天）
- 餐廳評分緩存（7 天）

---

## 第八部分：項目成果總結 📝

### 核心變化

- AI 從零到全功能識別與推薦，採用本地模型 + 雲端 API 混合方式

- 功能從單一賬單計算擴展到聚會管理、豐富多模塊和現代 UI

- 技術架構從單體進化到微服務、複雜數據管理、支持異步優化

### 學習收穫

- 實作 AI/ML（模型訓練、部署、API 集成）

- 前後端與 AI 全棧協同，微服務與資料庫設計運維

- 解決技術難題，優化性能及用戶體驗

---

## 第九部分：未來展望 🚀

### 1. AI 技術方向

- 持續優化現有模型準確率
- 逐步開發第三層（細粒度）食物識別
- 探索更多地區/菜系訓練
- 引入推薦機器學習（ML）強化餐廳推薦個人化
- 提升用戶粘性
- 深化 LLM 使用：擴展自動結構化、語義理解場景
- 如智能賬單摘要、分攤建議
- 健全模型監控、批量處理與自動容錯機制

### 2. 用戶體驗方向

- 增設獎勵與激勵機制（如上傳食物圖換取 OCR 次數）
- 賬單模板、多語言支持，滿足多元用戶需求
- 支持移動端和離線瀏覽，拓展使用場景
- 優化批量操作、智能提醒、數據導出，提升易用性

### 3. Docker 集成化

- 全功能 Docker 一鍵部署，降低運維門檻
- 集成所有服務（前端、後端、AI 微服務、數據庫等）於統一容器編排（如 Docker Compose）
- 支持自定義模型掛載、API 密鑰配置等參數化運行
- 優化持久化、備份與自動擴展方案，適合多類型部署環境

### 4. 廣告營利模式

- 考慮引入聚會相關廣告（如餐廳、支付、優惠券推廣）
- 打造自營或聯營廣告平台
- 推出 API 開放平台：允許第三方整合與按量收費
- 擴大影響力與收益
- 開發付費高級功能（如報表導出、推薦算法自定義、多租戶支持）
- 探索與餐廳/支付平台深度合作
- 提供商戶端接口與數據增值服務

---

## 結語

**PartyBillCalculator Plus** 項目展示了從基礎工具到智能系統的完整演進過程。

通過整合 OCR、圖像識別和推薦系統，我們不僅提升了功能豐富度，更重要的是建立了可擴展的 AI 驅動架構。

感謝老師的全力支持和中間不斷提供支援，這個課程讓我學到很多。

感謝大家的聆聽！

---

## 演講時間估算 ⏱

根據講稿內容和演示需求，預計演講時間：

**總時長**：約 **15-20 分鐘**

### 時間分配建議

- **開場白**：1 分鐘
- **項目概述**：1 分鐘
- **三大 AI 功能模塊**：5-6 分鐘
  - OCR 模塊：2 分鐘
  - 食物識別：2 分鐘
  - 餐廳推薦：1-2 分鐘
- **技術棧演進**：1 分鐘
- **開發路線圖**：2 分鐘
- **使用說明**：1 分鐘
- **模塊功能介紹**：3-4 分鐘
- **技術挑戰與解決**：2-3 分鐘
- **項目成果總結**：1 分鐘
- **未來展望**：1-2 分鐘
- **結語**：1 分鐘

**注意**：如果包含現場演示（OCR 識別、食物識別、餐廳推薦），建議預留額外 3-5 分鐘。

**建議總時長**：**18-25 分鐘**（含演示）
