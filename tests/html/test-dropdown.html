<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>下拉菜單測試 - PBC聚賬通</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      :root {
        --primary: #4f46e5;
        --primary-light: #e0e7ff;
        --dark: #1f2937;
        --light: #f8fafc;
      }

      .text-primary {
        color: var(--primary);
      }

      .bg-primary {
        background-color: var(--primary);
      }

      .bg-light {
        background-color: var(--light);
      }

      .text-dark {
        color: var(--dark);
      }
    </style>
  </head>

  <body
    class="font-sans text-dark bg-gray-50 min-h-screen"
    style="background-color: #f9fafb"
  >
    <!-- Header 將由 JavaScript 動態插入 -->

    <!-- 主要內容 -->
    <main class="pt-24 pb-20">
      <section class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h1 class="text-3xl font-bold mb-4 text-dark">
            下拉菜單 <span class="text-primary">測試</span>
          </h1>
          <p class="text-gray-600 max-w-2xl mx-auto text-lg">
            測試右上角用戶下拉菜單是否正常工作
          </p>
        </div>

        <div class="max-w-4xl mx-auto">
          <div class="bg-white rounded-2xl shadow-xl p-8">
            <h2 class="text-2xl font-bold mb-6">測試說明</h2>

            <div class="space-y-4">
              <div class="bg-blue-50 rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-2">測試步驟</h3>
                <ol class="list-decimal list-inside space-y-2 text-gray-700">
                  <li>查看右上角是否顯示用戶頭像和用戶名</li>
                  <li>點擊用戶頭像區域，應該會彈出下拉菜單</li>
                  <li>下拉菜單應該包含：個人資料、設置、退出登入</li>
                  <li>點擊頁面其他區域，下拉菜單應該自動關閉</li>
                  <li>點擊"退出登入"應該會跳轉到登錄頁面</li>
                </ol>
              </div>

              <div class="bg-green-50 rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-2">預期結果</h3>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li>✅ 用戶頭像和用戶名正確顯示</li>
                  <li>✅ 點擊後下拉菜單正常彈出</li>
                  <li>✅ 菜單項目可以正常點擊</li>
                  <li>✅ 點擊外部區域菜單自動關閉</li>
                  <li>✅ 登出功能正常工作</li>
                </ul>
              </div>

              <div class="bg-yellow-50 rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-2">故障排除</h3>
                <p class="text-gray-700 mb-2">如果下拉菜單不工作，請檢查：</p>
                <ul
                  class="list-disc list-inside space-y-1 text-sm text-gray-600"
                >
                  <li>瀏覽器控制台是否有 JavaScript 錯誤</li>
                  <li>是否已經登錄（需要登錄才能看到用戶信息）</li>
                  <li>頁面是否完全加載完成</li>
                </ul>
              </div>

              <div class="bg-gray-50 rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-2">登錄測試</h3>
                <p class="text-gray-700 mb-2">
                  如果沒有登錄，請先使用測試用戶登錄：
                </p>
                <div class="bg-white p-3 rounded border">
                  <p class="text-sm">
                    <strong>郵箱：</strong> test@example.com
                  </p>
                  <p class="text-sm"><strong>密碼：</strong> 123456</p>
                </div>
                <a
                  href="/login-test.html"
                  class="inline-block mt-2 text-primary hover:underline"
                >
                  前往登錄測試頁面 →
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer 將由 JavaScript 動態插入 -->

    <!-- 引入必要的腳本 -->
    <script src="/js/auth.js"></script>
    <script src="/js/components.js"></script>
    <script src="/js/page-setup.js"></script>

    <script type="module">
      // 頁面初始化
      document.addEventListener("DOMContentLoaded", async () => {
        try {
          // 設置頁面組件（需要認證）
          const pageInitialized = await window.pageSetup.init({
            currentPage: "test-dropdown",
            requireAuth: true,
            showHeader: true,
            showFooter: true,
          });

          if (pageInitialized) {
            console.log("下拉菜單測試頁面初始化成功");

            // 設置頁面特定功能
            window.pageSetup.setupPageFeatures({
              updateUserDisplay: true,
              setupLogout: true,
              setupAuthCheck: true,
            });

            console.log("下拉菜單測試頁面功能設置完成");
          } else {
            console.log("下拉菜單測試頁面初始化失敗");
          }
        } catch (error) {
          console.error("下拉菜單測試頁面初始化錯誤:", error);
        }
      });
    </script>
  </body>
</html>
